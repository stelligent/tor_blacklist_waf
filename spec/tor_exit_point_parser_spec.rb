require 'spec_helper'
require 'tor_exit_point_parser'
require 'set'

describe TorExitPointParser do

  context 'N records' do

    it 'returns N exit addresses' do

      expected_ip_addresses = %w(
      162.247.72.201
185.25.49.135
81.7.17.171
176.10.104.240
93.174.93.133
193.90.12.87
193.171.202.150
171.25.193.132
106.187.37.101
91.199.149.139
185.100.85.61
80.82.64.33
177.141.16.50
194.63.141.120
46.182.106.190
79.136.42.226
23.105.11.123
78.142.175.70
216.218.134.12
186.104.1.199
212.47.242.45
185.19.93.99
84.194.92.197
180.210.203.249
94.216.180.157
84.19.179.229
125.212.205.179
85.93.218.204
85.214.98.239
79.243.69.212
109.120.173.48
198.27.127.222
176.61.147.146
212.56.214.54
88.198.67.27
77.247.181.162
109.190.200.97
185.65.200.93
209.159.137.59
37.135.76.13
193.0.100.130
77.93.203.156
78.198.124.107
95.215.44.194
99.95.213.114
195.22.126.119
162.247.72.216
78.24.223.132
185.86.148.137
74.50.54.68
96.43.142.28
87.119.186.39
213.126.78.59
185.16.200.176
62.75.145.28
46.183.221.231
176.123.29.69
95.140.42.183
65.19.167.131
46.183.222.171
185.100.86.100
62.149.25.15
80.162.0.113
61.230.116.138
93.174.90.166
178.32.222.162
178.32.53.53
77.247.181.162
88.182.124.157
194.104.0.100
82.146.55.162
217.26.18.89
72.52.75.27
65.19.167.132
176.10.99.205
85.214.11.209
86.166.89.62
185.86.148.27
217.70.191.13
217.23.7.99
134.249.211.119
95.79.115.192
77.81.240.41
192.121.68.78
93.115.95.206
37.48.109.23
85.17.177.73
91.214.168.240
178.32.53.94
91.146.121.3
46.235.226.226
45.33.56.103
185.16.173.84
171.25.193.25
204.11.50.131
52.10.36.66
174.128.251.11
109.74.151.149
46.116.210.232
93.129.52.142
146.0.72.180
185.65.135.227
217.115.10.131
50.7.124.243
5.166.126.225
185.44.228.152
46.148.18.34
149.62.148.41
81.89.0.202
216.115.3.26
82.94.251.227
217.23.11.97
83.237.40.16
91.231.86.101
93.115.95.202
185.12.12.133
103.10.197.50
5.9.108.88
51.254.244.152
158.69.214.111
91.219.237.229
209.141.52.138
176.10.99.208
75.76.159.149
91.219.236.218
88.212.208.148
5.28.62.85
5.141.165.235
195.154.93.144
91.58.198.175
178.32.53.131
109.163.234.8
217.198.117.122
199.68.196.126
87.81.139.118
80.255.3.122
109.120.180.245
185.86.149.205
31.192.228.185
185.106.92.68
89.31.96.168
151.80.164.147
163.172.129.70
176.10.99.206
67.215.255.140
142.4.213.76
95.163.121.131
212.47.252.134
93.174.93.154
92.222.127.101
81.89.0.200
213.151.89.4
176.122.224.117
79.160.125.88
217.23.7.98
79.197.176.158
37.48.124.117
209.133.66.214
85.25.103.12
173.14.173.227
73.172.157.202
46.165.208.203
37.58.59.88
120.56.167.180
198.58.107.53
71.163.40.225
64.187.226.244
31.220.45.6
194.150.168.79
93.184.66.227
176.44.253.99
94.102.55.15
176.213.2.187
87.236.195.185
207.201.223.195
163.22.17.41
150.107.150.101
181.41.219.117
176.10.99.200
173.208.213.114
104.177.150.65
91.213.8.235
184.105.220.24
45.56.82.185
176.10.99.206
185.75.56.104
209.141.43.114
149.202.47.181
14.202.230.49
204.124.83.130
5.9.146.203
37.187.239.8
176.194.103.194
185.25.49.135
110.174.43.136
185.101.107.136
178.18.83.215
97.74.237.196
5.9.81.41
93.174.90.30
61.230.193.126
188.108.125.99
78.142.19.59
195.154.251.25
64.113.32.29
86.166.89.62
178.151.182.123
128.199.87.155
95.163.127.249
96.45.183.118
217.12.204.104
37.187.43.27
37.48.101.193
188.99.85.225
173.255.232.192
104.233.91.12
162.247.73.74
77.71.106.201
178.17.174.99
37.134.41.23
84.251.72.110
203.217.173.146
93.115.241.2
46.233.0.70
37.218.240.101
205.168.84.133
37.59.97.134
185.73.44.58
5.34.180.248
78.247.15.126
82.161.210.87
204.124.83.130
45.32.155.33
121.127.250.156
176.10.99.207
176.126.252.12
217.23.7.98
204.17.56.42
104.167.113.138
67.1.98.113
185.63.252.44
37.220.35.202
193.90.12.88
77.170.230.163
87.120.37.14
93.113.36.242
128.199.39.144
176.31.200.122
92.243.69.105
198.50.191.95
195.154.90.122
93.94.146.43
87.98.250.222
195.40.181.35
92.222.22.113
200.63.47.10
104.233.124.244
195.228.45.176
41.249.186.233
82.211.0.201
78.41.115.145
185.100.87.11
85.25.44.141
78.142.19.59
111.69.140.74
149.202.42.188
91.229.77.64
52.0.4.72
50.247.195.124
178.68.115.116
46.119.67.150
31.178.64.44
89.239.218.191
50.253.127.139
176.10.99.201
176.10.99.204
95.157.8.60
176.77.71.170
95.211.169.35
188.214.129.85
204.124.83.134
94.103.175.86
84.45.76.10
162.248.10.132
162.243.96.30
84.45.76.11
128.199.52.7
88.198.56.140
162.248.9.218
188.165.59.43
185.62.190.38
206.248.184.127
81.89.0.203
93.115.84.202
188.209.52.119
90.146.247.72
37.48.101.193
81.7.11.70
185.104.120.7
158.69.172.225
109.126.13.110
46.16.234.131
188.138.9.49
178.238.223.67
209.159.138.19
92.78.247.135
136.243.98.54
95.130.12.91
5.39.217.14
95.211.226.243
181.46.149.49
45.33.48.204
185.26.197.13
78.226.1.23
104.245.233.128
69.162.139.9
23.95.113.5
162.247.72.202
162.213.0.243
176.10.104.243
109.91.103.251
179.43.143.162
198.58.115.210
86.253.25.163
62.102.148.67
158.69.211.111
217.23.7.79
212.21.66.6
104.168.154.6
35.0.127.52
18.125.1.222
79.183.173.211
4.31.64.70
95.183.50.235
31.16.134.198
199.127.226.150
2.111.70.28
185.36.100.145
77.247.181.163
104.130.169.121
195.19.194.108
106.186.28.33
107.181.178.204
212.19.17.213
217.23.14.190
74.122.198.101
79.35.226.124
79.98.107.90
128.199.191.18
80.79.23.7
83.233.119.138
188.166.76.77
114.158.79.235
162.247.73.204
204.27.60.147
198.50.145.72
91.240.65.13
120.57.121.119
59.179.17.195
185.38.14.215
188.166.80.153
185.104.120.2
162.247.72.212
94.229.150.82
73.135.243.103
82.116.120.3
89.103.230.45
63.223.69.103
150.107.150.102
188.166.6.133
62.218.77.122
204.124.83.134
162.218.208.132
46.249.37.143
109.163.234.9
89.234.157.254
23.92.219.68
188.167.69.224
117.18.75.235
185.73.44.54
46.166.170.6
91.226.212.160
84.3.0.53
194.63.142.176
195.154.134.146
80.139.174.128
85.24.215.117
45.79.207.176
85.25.103.12
173.255.250.240
91.82.237.127
207.201.223.197
35.0.127.52
81.89.0.198
179.219.11.201
193.90.12.90
185.100.85.138
109.163.234.5
51.255.202.66
212.7.200.15
185.17.144.138
37.187.129.166
31.185.27.1
185.82.216.40
207.244.70.35
185.17.184.228
120.29.217.46
37.59.123.142
217.23.11.95
84.255.239.131
93.115.95.204
95.163.127.251
90.224.68.51
85.25.211.101
37.48.124.117
193.90.12.89
84.48.199.78
185.86.149.127
91.206.142.70
65.181.118.10
5.135.158.101
176.10.99.202
95.128.43.164
106.185.49.137
85.25.103.119
193.90.12.86
192.198.82.60
159.203.11.12
62.149.12.153
198.46.142.47
62.212.73.141
158.69.192.220
89.187.142.208
82.211.19.143
77.247.181.165
185.61.149.51
104.131.206.23
212.16.104.33
94.199.51.101
193.107.85.61
109.173.56.190
178.162.216.42
81.245.205.142
188.235.42.31
188.126.90.201
136.0.2.134
192.155.95.222
178.62.197.118
50.199.1.178
213.108.105.71
5.189.146.133
217.23.7.99
176.10.99.204
104.208.247.43
213.163.71.135
65.181.112.128
95.211.188.207
69.172.229.199
87.169.124.120
71.19.157.127
40.76.65.92
209.141.58.210
109.163.234.4
5.199.130.188
95.130.11.147
37.187.176.64
94.102.49.175
80.110.190.147
89.238.77.4
162.247.72.27
195.154.15.227
64.18.82.164
79.134.255.200
46.148.18.74
87.115.90.244
78.66.111.35
212.83.40.239
192.42.115.102
185.100.85.147
141.239.243.208
149.202.12.126
72.51.224.209
162.247.73.206
46.4.55.177
62.210.37.82
89.187.144.122
185.104.120.3
217.34.135.230
95.154.24.73
89.34.237.12
107.204.6.243
193.200.241.195
108.32.49.20
46.165.208.194
151.80.175.238
60.248.162.179
46.29.248.238
62.210.105.116
37.134.41.23
176.126.85.175
188.126.81.155
94.26.140.150
84.92.24.214
162.247.72.217
37.48.81.27
188.40.50.75
82.69.50.50
162.251.167.74
147.75.194.73
185.61.148.189
213.136.71.21
204.194.29.4
171.25.193.131
139.162.10.72
176.37.40.213
176.10.99.203
62.210.129.246
95.215.46.72
212.47.240.182
185.101.156.141
37.59.63.190
176.58.89.182
77.247.181.162
204.85.191.30
176.10.99.208
176.10.99.201
185.100.84.82
46.246.93.70
58.8.143.119
199.87.154.251
65.52.150.162
209.141.43.84
185.31.136.244
185.75.56.110
89.163.225.207
151.45.97.92
142.4.206.84
141.138.141.208
81.172.21.38
174.50.84.240
104.233.92.73
185.100.85.192
95.79.201.233
195.254.135.76
59.177.69.17
107.141.170.82
185.117.82.132
192.42.116.16
91.213.8.84
90.146.134.80
90.58.51.64
151.80.138.19
46.28.68.158
77.51.203.112
217.23.11.97
192.87.28.82
94.23.252.31
216.17.110.252
162.247.72.213
178.32.53.154
54.88.228.147
46.20.13.195
80.241.60.207
95.69.233.211
77.102.66.134
209.141.43.84
217.12.223.74
79.219.232.71
46.235.227.70
212.47.226.184
176.10.104.243
87.118.84.181
89.34.26.126
65.19.167.130
91.233.106.121
149.202.167.26
178.77.125.95
77.93.203.34
80.244.81.191
95.163.107.50
81.89.0.204
213.95.21.54
77.93.203.171
204.17.56.42
91.109.29.120
89.73.46.110
193.107.85.56
213.61.149.100
89.46.100.182
88.190.118.95
151.80.38.15
81.7.15.115
91.213.8.236
82.221.129.96
104.167.99.191
217.23.14.168
91.219.236.232
212.92.219.15
78.46.120.80
85.23.243.147
5.79.68.161
46.162.192.166
79.172.193.32
193.9.28.180
178.238.237.44
89.234.157.254
192.99.13.133
195.228.75.131
70.164.255.174
128.72.153.54
178.238.225.108
192.99.2.137
31.31.74.47
85.113.49.205
178.33.26.3
141.255.189.161
162.221.202.230
167.114.184.95
204.8.156.142
190.181.124.34
5.249.145.164
176.10.104.243
83.238.163.214
88.148.180.198
176.126.85.176
84.45.76.12
109.201.133.100
94.102.52.41
190.10.8.50
198.50.200.131
173.255.229.8
91.138.5.145
212.47.246.21
14.136.236.132
37.58.52.30
178.162.205.28
172.98.67.135
46.167.245.51
37.187.19.140
151.74.185.167
37.233.99.157
50.76.159.218
178.62.217.233
95.130.12.37
178.148.83.198
185.100.86.128
46.10.111.95
104.233.103.132
95.142.161.63
37.48.120.196
212.68.41.83
93.115.95.201
151.1.182.128
107.181.161.169
84.231.75.120
212.117.180.21
91.105.23.243
72.14.179.10
68.71.46.138
146.185.177.103
134.3.54.196
51.255.33.216
77.81.104.124
185.100.85.190
81.89.0.195
195.154.56.44
91.121.192.154
62.133.130.105
139.162.144.155
217.115.10.132
45.62.236.201
95.163.127.250
198.50.200.131
176.31.215.157
46.165.230.5
171.25.193.77
185.25.117.98
80.82.64.33
95.105.164.157
74.207.248.110
91.196.50.121
65.183.154.104
173.255.226.142
185.129.62.63
171.25.193.78
217.23.7.25
209.58.176.42
128.52.128.105
89.18.174.19
178.252.28.200
92.221.62.34
37.123.132.240
93.174.89.138
82.6.4.9
162.247.72.200
178.175.128.50
176.10.99.207
188.40.178.5
178.141.2.220
96.43.142.28
94.142.242.84
81.89.0.197
90.182.235.46
187.20.170.159
195.62.53.58
85.158.152.122
176.9.145.194
5.79.70.174
185.75.56.118
217.23.11.98
104.233.114.80
92.222.6.12
23.20.176.197
94.242.253.92
23.239.10.144
185.100.86.86
87.98.178.61
84.215.131.93
81.89.0.196
95.96.163.46
185.129.62.62
77.109.117.66
176.10.99.203
71.200.85.150
176.10.104.240
51.255.38.230
46.165.223.217
45.55.170.65
81.89.0.201
158.69.215.7
37.187.7.74
91.203.5.165
185.61.149.41
104.232.3.33
5.196.66.162
95.211.226.242
176.126.252.11
176.10.104.240
104.233.108.86
93.115.95.216
79.35.234.239
90.227.65.227
192.42.115.101
93.115.95.207
93.186.14.70
217.23.7.25
95.25.170.5
86.253.69.197
162.247.72.199
89.72.44.205
194.150.168.95
103.236.201.110
185.82.217.25
109.163.234.2
89.218.16.7
79.210.250.200
178.175.131.194
65.181.120.250
77.93.203.35
77.247.180.160
178.17.174.10
185.100.85.191
162.251.167.74
67.55.114.84
178.238.232.110
163.172.129.70
88.77.219.112
31.19.176.18
125.103.248.154
199.87.154.255
217.115.10.134
5.79.68.161
85.143.95.50
85.248.227.164
71.135.46.131
176.10.99.209
91.138.4.11
185.100.85.132
5.2.128.74
95.215.45.142
93.211.255.45
146.185.150.219
94.102.53.177
103.240.91.7
128.153.145.125
98.142.47.54
94.242.253.92
174.128.251.11
95.85.10.71
62.141.120.218
5.9.243.44
197.231.221.211
198.96.155.3
87.252.5.163
46.242.66.240
81.2.242.62
68.112.155.93
176.10.99.209
37.97.140.239
80.169.241.76
83.220.169.176
31.220.5.162
94.198.100.17
188.209.52.109
208.111.35.80
46.226.108.26
77.37.218.145
5.196.1.129
89.46.100.13
209.141.52.138
99.239.60.121
78.42.236.16
5.2.138.119
217.23.14.190
176.10.99.205
46.165.208.203
37.58.59.88
84.53.232.154
109.163.234.7
166.70.15.14
188.120.253.39
5.157.82.219
213.186.7.232
121.54.175.50
82.66.140.131
93.95.228.125
50.7.124.243
153.92.44.90
178.20.55.18
176.126.85.176
5.135.85.23
188.129.49.157
193.107.85.57
186.214.57.200
173.254.216.69
179.0.194.199
74.122.198.101
188.78.209.211
85.248.227.163
193.111.136.162
104.167.102.244
162.219.2.177
80.162.0.113
211.76.55.92
192.99.41.217
98.26.111.49
185.14.28.109
212.7.217.32
178.162.199.35
178.162.199.92
124.27.139.12
217.23.11.98
169.239.128.38
74.142.74.156
80.248.208.131
5.61.34.63
37.130.227.133
78.107.237.16
104.168.162.72
66.180.193.219
204.13.164.54
176.126.85.175
188.166.6.6
193.40.252.113
37.112.225.142
217.23.11.95
158.69.201.229
150.145.1.88
212.47.230.239
46.246.40.159
95.223.204.243
192.34.80.176
108.166.168.158
91.234.226.35
201.93.255.113
62.57.160.237
197.167.45.252
110.93.23.170
217.23.86.150
93.115.95.216
176.10.99.200
192.42.116.16
197.231.221.211
104.233.108.86
76.85.207.212
207.192.69.165
83.227.52.174
41.223.53.141
195.154.10.106
189.90.49.34
213.95.21.59
66.85.131.72
151.80.164.147
162.248.11.176
46.28.110.136
37.48.80.101
69.164.207.234
185.29.8.132
199.68.196.124
172.97.103.47
188.138.9.49
173.254.216.68
107.181.174.84
185.100.86.69
212.47.243.140
37.48.115.224
216.17.99.183
78.70.160.25
78.128.40.89
176.31.45.7
73.170.221.184
192.42.113.102
198.50.200.135
31.209.59.117
46.20.1.98
185.34.33.2
163.22.17.40
46.148.26.78
195.169.125.226
176.116.104.49
104.208.241.245
178.57.218.42
185.62.190.38
84.45.76.13
24.233.74.111
159.203.15.136
82.128.249.249
198.51.75.165
78.193.86.3
90.231.152.159
124.170.40.168
91.213.8.64
62.212.84.229
92.152.247.65
176.10.104.240
96.35.130.131
208.94.242.222
85.119.83.158
109.173.56.70
109.169.33.163
80.240.139.111
5.175.194.69
171.25.193.20
185.100.85.101
83.236.208.78
176.10.104.243
92.222.38.67
94.242.57.2
188.68.229.144
31.22.104.111
203.161.103.17
178.17.41.141
82.98.72.110
37.123.132.133
88.198.253.13
209.141.43.114
89.163.220.14
109.210.233.100
54.68.29.170
212.24.144.188
81.5.112.46
88.116.235.206
188.209.52.109
162.244.25.249
86.11.185.52
5.199.142.195
178.200.36.2
212.26.245.34
62.205.133.251
46.182.18.111
176.10.99.202
167.88.40.232
95.183.52.47
41.212.37.123
162.247.72.7
92.252.81.253
213.21.123.232
139.162.20.241
158.69.208.131
93.115.95.205
162.243.100.225
95.130.11.155
188.226.192.48
176.58.100.98
59.127.163.155
198.27.119.92
77.200.5.218
139.162.217.219
149.56.12.25
185.65.121.134
173.254.216.66
90.216.186.49
109.200.130.62
88.198.14.171
176.121.81.51
52.49.227.14
176.10.99.200
94.242.246.24
217.75.208.131
91.219.236.222
171.25.193.235
108.61.212.102
173.255.196.30
192.87.28.28
45.32.234.49
199.68.196.125
91.220.220.5
210.211.122.204
94.242.57.38
84.10.161.99
212.92.191.238
51.255.38.231
62.198.122.172
158.130.0.242
149.202.98.160
142.4.213.25
178.20.55.16
82.249.212.212
188.187.130.3
86.56.175.82
178.162.199.35
185.61.149.193
103.56.207.84
85.93.18.64
194.218.3.79
5.135.199.14
95.154.88.252
89.33.16.250
65.181.123.254
5.9.158.75
78.107.240.9
129.127.254.213
193.33.216.23
91.250.241.241
192.99.2.137
212.83.40.238
5.79.255.105
185.86.78.67
95.211.188.207
37.59.112.7
146.115.145.143
82.228.252.20
92.195.121.124
77.247.181.165
94.242.246.23
185.86.148.17
46.105.61.142
37.59.14.201
135.23.129.2
212.227.20.116
2.110.136.110
95.130.13.157
188.40.227.34
185.104.120.4
81.89.0.199
106.187.99.148
95.211.188.24
141.239.152.66
195.228.45.176
192.198.82.60
95.183.52.47
87.118.91.140
207.201.223.196
37.187.119.59
149.202.98.161
71.70.229.92
95.211.205.151
178.209.50.151
104.237.152.195
178.32.53.94
104.233.123.202
209.249.180.198
      )
      tor_exit_point_parser = TorExitPointParser.new
      actual_exit_ip_addresses = tor_exit_point_parser.ip_addresses IO.read('spec/tor_exit_point_example.txt')

      expect(Set.new(actual_exit_ip_addresses)).to eq Set.new(expected_ip_addresses)
    end
  end
end
